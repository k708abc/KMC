可能な限りc++の機能を使って書いた。
listをvectorに置き換え、ほぼすべてのフォルダにpxdファイルを作ることでcimportした。
シミュレーション自体はうまく行っているようだが、速度は非常に遅くなった（比較用パラメータセットで50 ms/loop）。
原因は今のところ分からず。